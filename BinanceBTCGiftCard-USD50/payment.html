<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Choose Your Crypto</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f6fa;
      color: #1d1d1d;
    }

    .header {
      background-color: #0d1a30;
      color: white;
      padding: 15px 20px;
      font-size: 22px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .container {
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }

    .pay-info {
      font-size: 15px;
      font-weight: bold;
      color: #303030;
      background-color: #fffefe;
      padding: 15px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .pay-info span {
      font-size: 15px;
      color: #e91e63;
      font-weight: bold;
    }

    .crypto-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .crypto-option {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: #fff;
      border: 2px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      font-size: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .crypto-option:hover {
        border-color: #e91e63;
        box-shadow: 0 0 8px rgba(233, 30, 99, 0.4);
    }

    .crypto-option.active {
      border-color: transparent;
      border-left: 4px solid #e91e63;
      background-color: #fff0f6;
      transform: scale(1.01);
    }

    .crypto-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .crypto-left img {
      width: 24px;
      height: 24px;
    }

    .pay-button {
      margin-top: 30px;
      width: 100%;
      padding: 16px;
      background: #e91e63;
      color: white;
      border: none;
      border-radius: 30px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }

    .pay-button:hover {
      background: #d81b60;
    }

    .pay-button:disabled {
      background: #b0bec5;
      cursor: not-allowed;
    }

    .pay-button {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: calc(100% - 40px); /* margin from both sides */
  max-width: 500px;
  padding: 16px;
  background: #e91e63;
  color: white;
  border: none;
  border-radius: 30px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
  z-index: 1000;
}

.pay-button:hover {
  background: #d81b60;
}

.pay-button:disabled {
  background: #b0bec5;
  cursor: not-allowed;
}
  </style>
  <!-- Meta Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1137994498129418');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1137994498129418&ev=PageView&noscript=1"
  /></noscript>
  <!-- End Meta Pixel Code -->
</head>
<body>

  <div class="header">AR-Pay Global</div>

  <div class="container">
    <div class="pay-info">
      You're paying: <span id="price-display">Loading...</span>
    </div>

    <div style="margin-bottom: 20px;">
      <div style="display: flex; align-items: center; gap: 10px; font-size: 20px; font-weight: bold; color: #0d1a30;">
        <img src="https://files.catbox.moe/wzhwcc.png" alt="Wallet Icon" style="width: 40px; height: 34px;">
        Choose your crypto
      </div>
    
      <!-- Progress Bar -->
    </div>

    <div class="pay-info" id="converted-display" style="display: none;">
      Equivalent in <span id="coin-name">Coin</span>: 
      <span id="coin-amount">--</span>
    </div>

    <div class="crypto-list">
      <div class="crypto-option" data-coin="Bitcoin">
        <div class="crypto-left">
          <img src="https://files.catbox.moe/mg2nn8.png" alt="Bitcoin" />
          <span>Bitcoin</span>
        </div>
        <span>BTC</span>
      </div>

      <div class="crypto-option" data-coin="Ethereum">
        <div class="crypto-left">
          <img src="https://files.catbox.moe/7qemhr.png" alt="Ethereum" />
          <span>Ethereum</span>
        </div>
        <span>ETH</span>
      </div>

      <div class="crypto-option" data-coin="USDT">
        <div class="crypto-left">
          <img src="https://files.catbox.moe/kv99kw.png" alt="USDT" />
          <span>USDT</span>
        </div>
        <span>USDT</span>
      </div>

      <div class="crypto-option" data-coin="USD Coin">
        <div class="crypto-left">
          <img src="https://files.catbox.moe/0yoacd.png" alt="USDC" />
          <span>USD Coin</span>
        </div>
        <span>USDC</span>
      </div>

      <div class="crypto-option" data-coin="Litecoin">
        <div class="crypto-left">
          <img src="https://files.catbox.moe/ri45tv.png" alt="Litecoin" />
          <span>Litecoin</span>
        </div>
        <span>LTC</span>
      </div>
    </div>

    <button class="pay-button" id="payButton" disabled>Select a Coin</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const price = parseFloat(urlParams.get('price'));
      const priceDisplay = document.getElementById('price-display');
      const options = document.querySelectorAll('.crypto-option');
      const payButton = document.getElementById('payButton');
    
      let selectedCoin = '';
      let exchangeRates = {};
    
      if (price) {
        priceDisplay.textContent = `${price} USD`; // Afficher en USD
      } else {
        priceDisplay.textContent = 'No price found';
      }
    
      // 🟢 Récupérer les taux de change depuis Binance
      async function fetchRates() {
        try {
          const response = await fetch('https://api.binance.com/api/v3/ticker/price');
          const data = await response.json();
    
          // Mapping coins to USD rates
          exchangeRates = {
            Bitcoin: getRate(data, 'BTCUSDT'),
            Ethereum: getRate(data, 'ETHUSDT'),
            USDT: getRate(data, 'USDTUSDT'), // USDT is already 1 USD
            'USD Coin': 1, // USD Coin = 1 USD
            Litecoin: getRate(data, 'LTCUSDT'),
          };
        } catch (error) {
          alert('Failed to fetch crypto rates ❌');
        }
      }
    
      function getRate(data, symbol) {
        const item = data.find(e => e.symbol === symbol);
        return item ? parseFloat(item.price) : 1;
      }
    
      // 🎯 Quand on clique sur une crypto
      options.forEach(option => {
        option.addEventListener('click', () => {
          options.forEach(opt => opt.classList.remove('active'));
          option.classList.add('active');
    
          selectedCoin = option.getAttribute('data-coin');
          payButton.disabled = false;
    
          // Conversion logic for USD
          const rate = exchangeRates[selectedCoin];
          const usdAmount = parseFloat(price);
    
          if (rate && usdAmount) {
            const converted = (usdAmount / rate).toFixed(6);
            document.getElementById("coin-name").textContent = selectedCoin;
            document.getElementById("coin-amount").textContent = `${converted} ${selectedCoin}`;
            document.getElementById("converted-display").style.display = "flex";
            
            // Mise à jour du texte du bouton avec le montant converti
            payButton.innerText = `Pay ${converted} ${selectedCoin}`;
          } else {
            document.getElementById("converted-display").style.display = "none";
          }
        });
      });
    
      // 🚀 Redirection avec amount exacte
      payButton.addEventListener('click', () => {
        if (selectedCoin && price && exchangeRates[selectedCoin]) {
          const amount = (price / exchangeRates[selectedCoin]).toFixed(8);
          let page = `payment${selectedCoin.toLowerCase().replace(' ', '')}.html`;
          window.location.href = `${page}?amount=${amount}`;
        }
      });
    
      fetchRates(); // Charger les taux automatiquement
    });
  </script>

  <!-- Loader with GIF -->
  <div id="loader">
    <img src="https://www.epidomastegasis.gr/gov/Content/images/loaders/loader4.gif" alt="Loading...">
  </div>

  <script>
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("loader").style.display = "none";
        document.getElementById("pageContent").style.display = "block";
      }, 5000);
    });
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
  
    html, body {
      height: 100%;
      font-family: sans-serif;
    }
  
    /* Loader container */
    #loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
  
    /* Big centered GIF */
    #loader img {
      width: 70px;
      height: 70px;
    }
  
    /* Page content */
    #pageContent {
      display: none;
      padding: 20px;
      text-align: center;
    }
  </style>

</body>
</html>
